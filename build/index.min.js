/**
 * PriorityMenu  1.0.0
 * GitHub template for starting new projects
 * https://github.com/Fapalz/priority-menu#readme
 *
 * Copyright 2020-2021 Gladikov Kirill - Fapalz <blacesmot@gmail.com>
 *
 * Released under the MIT License
 *
 * Released on: March 5, 2021
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).PriorityMenu=e()}(this,(function(){"use strict";return function(){function t(e,i){if(this.options=t.mergeSettings(i),this.element="string"==typeof e?document.querySelector(e):e,!(o=this.element)||1!==o.nodeType)throw new Error("Element shold be is ELEMENT_NODE, check your parameter");var o;this.resizeListener=null,this.isInit=!1,this.mq=!1,window.matchMedia&&this.options.breakpointDestroy?(this.mq=window.matchMedia(this.options.breakpointDestroy),this.mq.addEventListener("change",this.mqDestroy.bind(this)),this.mqDestroy(this.mq)):this.init()}t.mergeSettings=function(t){var e={containerSelector:!1,containerWidthOffset:10,itemsListSelector:!1,delay:300,breakpointDestroy:!1,updateWidthOnResize:!1,dropdownMenuId:!1,dropdownLabel:'More <i class="caret"></i>',dataMenu:"data-priority-menu",dataMenuList:"data-priority-menu-list",dataStableItem:"data-priority-menu-stable",dataOverflowItem:"data-priority-menu-overflow",menuItemClass:"dropdown",dropdownToogleClass:"dropdown-toggle",dropdownMenuClass:"dropdown-menu",dropdownMenuTemplate:'<li {{dataMenu}} class="{{menuItemClass}}" aria-hidden="true"><a id="{{dropdownMenuId}}" href="#" class="{{dropdownToogleClass}}" role="button" aria-haspopup="true" aria-expanded="false">{{dropdownLabel}}</a><ul class="{{dropdownMenuClass}}" {{dataMenuList}} aria-labelledby="{{dropdownMenuId}}"></ul></li>',moved:function(){},movedBack:function(){}};return Object.keys(t).forEach((function(i){e[i]=t[i]})),e};var e=t.prototype;return e.mqDestroy=function(t){t.matches?this.isInit&&this.destroy():this.isInit||this.init()},e.createOverflowMenu=function(){var t=this.itemsList.querySelector("["+this.options.dataMenu+"]");if(!t){var e=this.options.dropdownMenuId?this.options.dropdownMenuId:"priority-menu-more-"+function(t){for(var e="";e.length<t;)e+=Math.random().toString(36).substring(2);return e.substring(0,t)}(6),i=this.options.dropdownMenuTemplate.replace("{{dropdownLabel}}",this.options.dropdownLabel).replace("{{menuItemClass}}",this.options.menuItemClass).replace("{{dropdownToogleClass}}",this.options.dropdownToogleClass).replace("{{dropdownMenuClass}}",this.options.dropdownMenuClass).replace("{{dataMenu}}",this.options.dataMenu).replace("{{dataMenuToggle}}",this.options.dataMenuToggle).replace("{{dataMenuList}}",this.options.dataMenuList).replace(new RegExp("{{dropdownMenuId}}","g"),e),o=document.createElement("div");o.innerHTML=i,this.itemsList.appendChild(o.firstChild),t=this.itemsList.querySelector("["+this.options.dataMenu+"]")}if(!t)throw new Error("overflowMenu does not exist, check your custom dropdownMenuTemplate parameter");return t},e.getBreakpoints=function(){for(var t=[],e=this.itemsList.children,i=e.length,o=0,s=0,n=0;n<i;n+=1){var r=e[n];r.hasAttribute(this.options.dataMenu)||(r.hasAttribute(this.options.dataStableItem)?o+=Math.ceil(r.offsetWidth):(s+=Math.ceil(r.offsetWidth),t.push(s)))}return this.stableItemsWidth=o,t},e.attachEvents=function(){var t,e,i,o,s;0===this.options.delay?this.resizeListener=this.reflowNavigation.bind(this):this.resizeListener=(t=this.reflowNavigation,e=this.options.delay,i=this,void 0===e&&(e=250),function(){for(var n=arguments.length,r=new Array(n),h=0;h<n;h++)r[h]=arguments[h];var a=i||this,l=+new Date;o&&l<o+e?(clearTimeout(s),s=setTimeout((function(){o=l,t.apply(a,r)}),e)):(o=l,t.apply(a,r))}),window.addEventListener("resize",this.resizeListener)},e.detachEvents=function(){window.removeEventListener("resize",this.resizeListener),this.resizeListener=null},e.updateDropdownMenuWidth=function(){var t=this.overflowList.children.length;if(t<=0)this.dropdownMenuWidth=0;else{if(t>0&&this.dropdownMenuWidth>0&&!this.options.updateWidthOnResize)return this.dropdownMenuWidth;this.dropdownMenuWidth=Math.ceil(this.overflowMenu.offsetWidth)}return this.dropdownMenuWidth},e.updateContainerWidth=function(){return this.containerWidth=Math.ceil(this.container.offsetWidth-this.options.containerWidthOffset),this.containerWidth},e.updateItemsWidth=function(){this.removeAllFromOverflow(),this.breakpoints=this.getBreakpoints()},e.getAvailableContainerWidth=function(){return this.containerWidth-this.stableItemsWidth-this.dropdownMenuWidth},e.addToOverflow=function(t,e){return t.setAttribute(this.options.dataOverflowItem,!0),this.overflowList.insertBefore(t,this.overflowList.firstChild),this.overflowBreakpoints.unshift(e),this.breakpoints.pop(),this.overflowBreakpoints},e.removeFromOverflow=function(t,e){return t.removeAttribute(this.options.dataOverflowItem),this.breakpoints.push(e),this.overflowBreakpoints.shift(),this.itemsList.insertBefore(t,this.overflowMenu),this.overflowBreakpoints},e.toggleOverflowDropdown=function(t){return this.overflowMenu.setAttribute("aria-hidden",t)},e.getCountOverflowItems=function(){for(var t=this.overflowList.children,e=0,i=0;i<t.length;i+=1)t[i].hasAttribute(this.options.dataOverflowItem)&&(e+=1);return e},e.reflowNavigation=function(){if(!this.resizeListener)return!1;this.options.updateWidthOnResize&&this.updateItemsWidth();for(var t=this.itemsList.children,e=t.length,i=[],o=0;o<t.length;o+=1){var s=t[o];s.hasAttribute(this.options.dataMenu)||s.hasAttribute(this.options.dataStableItem)||i.push(s)}for(this.updateDropdownMenuWidth(),this.updateContainerWidth(),e=i.length;e;){e-=1;var n=this.breakpoints[e];n>=this.getAvailableContainerWidth()&&(this.addToOverflow(i[e],n),this.updateDropdownMenuWidth())}for(var r=this.getCountOverflowItems();r;)r-=1,(this.overflowBreakpoints[0]<this.getAvailableContainerWidth()||!this.overflowAlways&&this.overflowBreakpoints[this.overflowBreakpoints.length-1]<this.getAvailableContainerWidth()+this.dropdownMenuWidth)&&(this.removeFromOverflow(this.overflowList.children[0],this.overflowBreakpoints[0]),this.updateDropdownMenuWidth());return this.toggleOverflowDropdown(0===this.overflowList.children.length)},e.removeAllFromOverflow=function(){for(var t=this.getCountOverflowItems();t;)t-=1,this.removeFromOverflow(this.overflowList.children[0],this.overflowBreakpoints[0])},e.destroy=function(){this.detachEvents();for(var t=this.getCountOverflowItems();t;)t-=1,this.removeFromOverflow(this.overflowList.children[0],this.overflowBreakpoints[0]);return this.toggleOverflowDropdown(0===this.overflowList.children.length),this.isInit=!1,this.element},e.init=function(){if(!this.isInit){if(this.container=void 0,this.itemsList=void 0,this.containerWidth=0,this.dropdownMenuWidth=0,this.stableItemsWidth=0,this.container=this.options.containerSelector&&this.element.querySelectorAll(this.options.containerSelector)[0]?this.element.querySelectorAll(this.options.containerSelector)[0]:this.element,this.itemsList=this.options.itemsListSelector&&this.element.querySelectorAll(this.options.itemsListSelector)[0]?this.element.querySelectorAll(this.options.itemsListSelector)[0]:this.element,this.overflowMenu=this.createOverflowMenu(),this.overflowList=this.overflowMenu.querySelector("["+this.options.dataMenuList+"]")||this.overflowMenu.querySelectorAll("ul")[0],!this.overflowList)throw new Error("overflowList does not exist, check your custom dropdownMenuTemplate parameter");this.overflowAlways=this.overflowList.children.length>0,this.overflowBreakpoints=[],this.elementStyle=window.getComputedStyle(this.element),this.breakpoints=this.getBreakpoints(),this.attachEvents(),this.reflowNavigation(),this.isInit=!0}},t}()}));
//# sourceMappingURL=index.min.js.map